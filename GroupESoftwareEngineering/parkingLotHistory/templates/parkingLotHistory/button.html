<h2>Parking History</h2>
    <table id="historyTable">
        <thead>
            <tr>
                <th>#</th>
                <th>Building Name</th>
                <th>Lot Name</th>
                <th>Distance</th>
                <th>Timestamp</th>
            </tr>
        </thead>
        <tbody>
            <!-- History entries will be appended here -->
        </tbody>
    </table>

    <script>
        const parkingHistory = [];

        function showBuildingInfo() {
            const select = document.getElementById("buildingSelect");
            const buildingId = select.value;
            const buildingName = select.options[select.selectedIndex].text;

            if (!buildingId) {
                alert("Please select a building first!");
                return;
            }

            fetch(`/building/${buildingId}/`)
                .then(response => {
                    if (!response.ok) throw new Error("Building not found");
                    return response.json();
                })
                .then(data => {
                    // Update building info box
                    document.getElementById("closestLot").innerText = data.closestLot;
                    document.getElementById("distance").innerText = data.distance + " miles";

                    // Add to history
                    const timestamp = new Date().toLocaleString();
                    parkingHistory.push({
                        building_name: buildingName,
                        lot_name: data.closestLot,
                        distance: data.distance,
                        timestamp: timestamp
                    });

                    // Render history table
                    renderHistory();
                })
                .catch(err => console.error("Error:", err));
        }

        function renderHistory() {
            const tbody = document.getElementById("historyTable").querySelector("tbody");
            tbody.innerHTML = "";

            parkingHistory.forEach((record, index) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${record.building_name}</td>
                    <td>${record.lot_name}</td>
                    <td>${record.distance} miles</td>
                    <td>${record.timestamp}</td>
                `;
                tbody.appendChild(row);
            });
        }
    </script>